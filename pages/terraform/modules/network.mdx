import Callout from 'nextra-theme-docs/callout'

# tf/network/

Esse m√≥dulo √© respons√°vel pela cria√ß√£o de uma rede VPC, subnets, internet gateway, route table e nat gateway.

Vamos passar por cada recurso presente no arquivo `main.tf` e entender o que ele faz.

<Callout emoji="‚ö†Ô∏è">
    No caso deste m√≥dulo, ele √© executado apenas uma vez, diferentemente de modulos como `ec2`, pois n√£o √© necess√°rio criar uma nova rede para cada ambiente.
</Callout>

## aws_vpc

O primeiro recurso que criamos √© a VPC, que √© a nossa rede virtual.

```hcl
resource "aws_vpc" "vpc" {
  cidr_block = var.vpc_cidr_block
  enable_dns_hostnames = true
  enable_dns_support = true
  tags = {
    Name = var.vpc_name
  }
}
```

<Callout emoji="üìù">
    Aqui definimos o CIDR da nossa rede, que √© o endere√ßo de rede que ser√° utilizado para todas as subnets. 
    Al√©m disso, definimos o nome da VPC.
</Callout>

## aws_subnet

Agora vamos criar as subnets que ser√£o utilizadas na nossa VPC.

```hcl
resource "aws_subnet" "public_subnet" {
  vpc_id = aws_vpc.vpc.id
  cidr_block = var.public_subnet_cidr_block
  availability_zone = var.availability_zone
  map_public_ip_on_launch = true
  tags = {
    Name = var.public_subnet_name
  }
}
```

<Callout emoji="üìù">
    Aqui definimos o CIDR da nossa subnet p√∫blica, que √© o endere√ßo de rede que ser√° utilizado para a subnet p√∫blica. 
    Al√©m disso, definimos o nome da subnet.
</Callout>

## aws_route_table

Uma route table √© uma tabela de roteamento que define quais rotas ser√£o utilizadas para enviar pacotes de dados para uma determinada rede.

```hcl
resource "aws_route_table" "public_rt" {
  vpc_id = aws_vpc.vpc.id

  tags = {
    Name = "Public RT"
  }
}
```

## aws_route_table_association

Agora vamos associar a nossa subnet p√∫blica com a nossa route table.

```hcl
resource "aws_route_table_association" "public_rta" {
  subnet_id = aws_subnet.public_subnet.id
  route_table_id = aws_route_table.public_rt.id
}
```

## aws_internet_gateway

Agora vamos criar um internet gateway, que √© um recurso que permite que a nossa VPC tenha acesso √† internet.

```hcl
resource "aws_internet_gateway" "igw" {
  vpc_id = aws_vpc.vpc.id

  tags = {
    Name = "IGW"
  }
}
```

## aws_route

Uma route √© uma regra que define como o tr√°fego ser√° encaminhado para uma determinada rede.

```hcl
resource "aws_route" "default_route" {
  route_table_id         = aws_route_table.public_rt.id
  destination_cidr_block = "0.0.0.0/0"
  gateway_id             = aws_internet_gateway.igw.id
}
```

<Callout emoji="üìù">
    Aqui definimos a rota padr√£o para a nossa VPC, que √© a rota que ser√° utilizada para enviar pacotes de dados para a internet.
</Callout>